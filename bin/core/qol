#!/usr/bin/env bash

# This script installs the symlinks from the modules in src/
# to the bin/ directory.

if [[ -z "${QOL_SCRIPTS_PATH}" ]]; then
    echo "Set QOL_SCRIPTS_PATH in your environment to use this helper."
    # Note: do not copy from this line into your shell RC (setting QOL_SCRIPTS_PATH to PWD). 
    # This is to make the error show the path it should be 
    # in the terminal.
    echo "Example: export QOL_SCRIPTS_PATH=$PWD"
    exit 1
fi   
    

if [ "$1" == "install" ]; then

    if [ "$#" -lt 2 ]; then
    echo "Error: Two arguments are required."
    echo "Usage: $0 install <app>"
    exit 1
    fi

    ln -s $QOL_SCRIPTS_PATH/src/$2 $QOL_SCRIPTS_PATH/bin/$2
    if [ "$?" -eq 0 ]; then
        echo "$2 successfully installed"
    else
        echo "$2 did not install successfully."
    fi

elif [ "$1" == "uninstall" ]; then

    rm $QOL_SCRIPTS_PATH/bin/$2
    if [ "$?" -eq 0 ]; then
        echo "$2 successfully uninstalled"
    else
        echo "$2 did not uninstall successfully."
    fi

elif [ "$1" == "list" ]; then

   ls -1 "$QOL_SCRIPTS_PATH/src"

elif [ "$1" == "update" ]; then

   $QOL_SCRIPTS_PATH/bin/core/qol-scripts-update

elif [ "$1" == "version" ]; then

   git -C $QOL_SCRIPTS_PATH --no-pager tag -l

else
   echo -e "Usage: qol install <script> \t Installs a script"
   echo -e "       qol uninstall <script> \t Removes a script"
   echo -e "       qol update \t\t Updates qol to latest"
   echo -e "       qol list \t\t Shows scripts available to install"
   echo -e "       qol version \t\t Shows qol version and exits."

fi